time complexity of prediction  = O(N*K^2)
space complexity of prediction = O(NK)
time complexity of training = O(K*N^2)
space complexity of training = O(N*K + N + K)